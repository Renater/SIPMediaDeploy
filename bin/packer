#!/bin/bash
set -eo pipefail

# Load packer configuration
source env.d/packer
export OS_AUTH_URL \
    OS_USERNAME \
    OS_PASSWORD \
    OS_REGION_NAME \
    OS_PROJECT_DOMAIN_ID \
    OS_USER_DOMAIN_NAME \
    OS_PROJECT_ID \
    OS_PROJECT_NAME \
    OS_INTERFACE \
    OS_IDENTITY_API_VERSION \
    PKR_VAR_GW_HOST_SOURCE \
    PKR_VAR_GW_HOST_FLAVOR \
    PKR_VAR_GW_HOST_NETWORK_ID \
    PKR_VAR_GW_HOST_SSH_USERNAME \
    PKR_VAR_KAMAILIO_SOURCE \
    PKR_VAR_KAMAILIO_FLAVOR \
    PKR_VAR_KAMAILIO_NETWORK_ID \
    PKR_VAR_KAMAILIO_SSH_USERNAME \
    PKR_VAR_COTURN_SOURCE \
    PKR_VAR_COTURN_FLAVOR \
    PKR_VAR_COTURN_NETWORK_ID \
    PKR_VAR_COTURN_SSH_USERNAME \
    PKR_VAR_SCALER_SOURCE \
    PKR_VAR_SCALER_FLAVOR \
    PKR_VAR_SCALER_NETWORK_ID \
    PKR_VAR_SCALER_SSH_USERNAME

# Launch packer
cd packer
packer "$@"
